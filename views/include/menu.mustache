<aside class="sidebar-left border-right bg-white" id="leftSidebar" data-simplebar>
    <a href="#" class="btn collapseSidebar toggle-btn d-lg-none text-muted ml-2 mt-3" data-toggle="toggle">
        <i class="fe fe-x"><span class="sr-only"></span></i>
    </a>

    <nav class="vertnav navbar navbar-light">
        <!-- nav bar -->
        <div class="w-100 mb-4 d-flex">
            <a class="navbar-brand mx-auto mt-2 flex-fill text-center" href="/">
                trackr
            </a>
        </div>

        <ul class="navbar-nav flex-fill w-100 mb-2">

            <li class="nav-item dropdown {{activeHome}}">
                <a href="/" class="nav-link">
                    <i class="fe fe-home fe-16"></i>
                    <span class="ml-3 item-text">Home</span>
                </a>
            </li>

            <li class="nav-item dropdown {{activeBooks}}">
                <a href="#menu-books-ddl" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle nav-link">
                    <i class="fe fe-book fe-16"></i>
                    <span class="ml-3 item-text">Books</span>
                </a>
                <ul class="collapse list-unstyled pl-4 w-100 {{showBooksDropdownList}}" id="menu-books-ddl">
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/books/paths">
                            <span class="ml-1 item-text">Paths</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/books">
                            <span class="ml-1 item-text">All</span>
                            <span id="allBooksBadgeCount" class="badge badge-pill badge-warning"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/books/finished">
                            <span class="ml-1 item-text">Finished</span>
                            <span id="finishedBooksBadgeCount" class="badge badge-pill badge-warning"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/books/my-library">
                            <span class="ml-1 item-text">Library</span>
                            <span id="myBooksBadgeCount" class="badge badge-pill badge-warning"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/books/reading-history">
                            <span class="ml-1 item-text">Reading History</span>
                        </a>
                    </li>
                </ul>
            </li>

            <li class="nav-item dropdown {{activeBookmarks}}">
                <a href="#menu-bookmarks-ddl" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle nav-link">
                    <i class="fe fe-bookmark fe-16"></i>
                    <span class="ml-3 item-text">Bookmarks</span>
                </a>
                <ul class="collapse list-unstyled pl-4 w-100 {{showBookmarksDropdownList}}" id="menu-bookmarks-ddl">
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/bookmarks">
                            <span class="ml-1 item-text">All</span>
                            <span id="bookmarksBadgeCount" class="badge badge-pill badge-warning"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/bookmarks">
                            <span class="ml-1 item-text">Unread</span>
                            <span id="bookmarksBadgeCount" class="badge badge-pill badge-warning"></span>
                        </a>
                    </li>
                </ul>
            </li>

            <li class="nav-item dropdown {{activeHighlights}}">
                <a href="#menu-highlights-ddl" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle nav-link">
                    <i class="fe fe-scissors fe-16"></i>
                    <span class="ml-3 item-text">Highlights</span>
                </a>
                <ul class="collapse list-unstyled pl-4 w-100 {{showHighlightsDropdownList}}" id="menu-highlights-ddl">
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/highlights"><span class="ml-1 item-text">All</span>
                            <span id="highlightsBadgeCount" class="badge badge-pill badge-warning"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/highlights?type=favorites">
                            <span class="ml-1 item-text">Favorites</span>
                            <span id="favoriteHighlightsCount" class="badge badge-pill badge-warning"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/highlights?type=public">
                            <span class="ml-1 item-text">Public</span>
                            <span id="publicHighlightsBadgeCount" class="badge badge-pill badge-warning"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link pl-3" href="/highlights?type=private">
                            <span class="ml-1 item-text">Private</span>
                            <span id="privateHighlightsBadgeCount" class="badge badge-pill badge-warning"></span>
                        </a>
                    </li>
                </ul>
            </li>

            <li class="nav-item dropdown {{activeChains}}">
                <a href="/chains" class="nav-link">
                    <i class="fe fe-command fe-16"></i>
                    <span class="ml-3 item-text">Chains</span>
                </a>
            </li>
            <li class="nav-item dropdown {{activeLogs}}">
                <a href="/logs" class="nav-link">
                    <i class="fe fe-align-justify fe-16"></i>
                    <span class="ml-3 item-text">Logs</span>
                </a>
            </li>
        </ul>

        <ul class="navbar-nav flex-fill w-100 mb-2">

            <div id="highlight-favorites"></div>

            {{=<% %>=}}
            <script id="highlight-favorites-template" type="text/html">
                    {{#highlightFavorites}}
                    <li class="nav-item dropdown">
                        <a href="/highlights?id={{highlightId}}" class="nav-link">
                        <i class="fe fe-arrow-right fe-16"></i>
                        <span class="ml-3 item-text">{{title}}</span>
                        </a>
                    </li>
                    {{/highlightFavorites}}
            </script>
            <%={{ }}=%>

        </ul>

        <div class="btn-box w-100 mt-4 mb-1">
            <a href="/logout" class="btn mb-2 btn-danger btn-lg btn-block">
                <i class="fe fe-log-out fe-12 mr-2"></i><span class="small text">Logout</span>
            </a>
        </div>

    </nav>

</aside>

<script>
    $(document).ready(function () {
        var resultBadgeCounts = ajaxCall('GET', "/menu-badge-counts", null, false, false);
        $('#allBooksBadgeCount').text(resultBadgeCounts.allBookCount);
        $('#myBooksBadgeCount').text(resultBadgeCounts.myBookCount);
        $('#finishedBooksBadgeCount').text(resultBadgeCounts.finishedBookCount);
        $('#bookmarksBadgeCount').text(resultBadgeCounts.bookmarkCount);
        $('#todosBadgeCount').text(resultBadgeCounts.todosCount);
        $('#videosBadgeCount').text(resultBadgeCounts.videosCount);
        $('#highlightsBadgeCount').text(resultBadgeCounts.highlightsCount);
        $('#publicHighlightsBadgeCount').text(resultBadgeCounts.publicHighlightsCount);
        $('#privateHighlightsBadgeCount').text(resultBadgeCounts.privateHighlightsCount);
        $('#favoriteHighlightsCount').text(resultBadgeCounts.favoriteHighlightsCount);

        var resultFavorites = ajaxCall('GET', "/favorites?type=highlight", null, false, false);
        var template = $('#highlight-favorites-template').html();
        Mustache.parse(template);
        var rendered = Mustache.render(template, resultFavorites.data);
        $("#highlight-favorites").html(rendered);
    });
</script>